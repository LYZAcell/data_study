{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/LYZAcell/data_study/blob/main/250312_10%E1%84%80%E1%85%B5_%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%87%E1%85%AE%E1%86%AB%E1%84%89%E1%85%A5%E1%86%A8%E1%84%89%E1%85%B5%E1%86%AF%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%87%E1%85%A1%E1%86%AB_GA4_%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5_%E1%84%8B%E1%85%B5%E1%84%92%E1%85%A2(1)_ipynb%EC%9D%98_%EC%82%AC%EB%B3%B8.ipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "038e8551",
      "metadata": {
        "id": "038e8551"
      },
      "outputs": [],
      "source": [
        "import pandas as pd"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "8ebdd71a",
      "metadata": {
        "id": "8ebdd71a"
      },
      "outputs": [],
      "source": [
        "df=pd.read_csv('2019-Dec.csv')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "16cc73ca",
      "metadata": {
        "id": "16cc73ca",
        "outputId": "347b6d4d-3ed1-430d-c12e-2d3893578b1a"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "<class 'pandas.core.frame.DataFrame'>\n",
            "RangeIndex: 3533286 entries, 0 to 3533285\n",
            "Data columns (total 9 columns):\n",
            " #   Column         Dtype  \n",
            "---  ------         -----  \n",
            " 0   event_time     object \n",
            " 1   event_type     object \n",
            " 2   product_id     int64  \n",
            " 3   category_id    int64  \n",
            " 4   category_code  object \n",
            " 5   brand          object \n",
            " 6   price          float64\n",
            " 7   user_id        int64  \n",
            " 8   user_session   object \n",
            "dtypes: float64(1), int64(3), object(5)\n",
            "memory usage: 242.6+ MB\n"
          ]
        }
      ],
      "source": [
        "df.info()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "50e5eb0b",
      "metadata": {
        "id": "50e5eb0b",
        "outputId": "925af7d4-7a0f-4395-f991-2e3d9abbd0c2"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "event_time             0\n",
              "event_type             0\n",
              "product_id             0\n",
              "category_id            0\n",
              "category_code    3474821\n",
              "brand            1510289\n",
              "price                  0\n",
              "user_id                0\n",
              "user_session         779\n",
              "dtype: int64"
            ]
          },
          "execution_count": 6,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "df.isna().sum()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "09d6cc1c",
      "metadata": {
        "id": "09d6cc1c",
        "outputId": "3092d159-e0f9-4893-d57f-8e7e29735a9b"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "                      event_time        event_type  product_id  \\\n",
            "1141402  2019-12-09 19:04:29 UTC              view     5814516   \n",
            "2826120  2019-12-23 12:44:51 UTC              view     5915004   \n",
            "354426   2019-12-03 16:25:54 UTC              view     5877456   \n",
            "3089023  2019-12-25 19:06:15 UTC              cart     5608703   \n",
            "1762400  2019-12-14 11:41:25 UTC              view     5769914   \n",
            "...                          ...               ...         ...   \n",
            "954138   2019-12-08 14:29:44 UTC  remove_from_cart     5695961   \n",
            "1363136  2019-12-11 10:17:56 UTC              cart     5800038   \n",
            "3033914  2019-12-25 10:03:55 UTC          purchase     5629984   \n",
            "3455329  2019-12-30 08:41:10 UTC          purchase     5851607   \n",
            "2220662  2019-12-17 21:18:58 UTC              cart     5678044   \n",
            "\n",
            "                 category_id category_code     brand   price    user_id  \\\n",
            "1141402  1487580013539623112           NaN       NaN   13.49  247790217   \n",
            "2826120  1487580008028308447           NaN  babyliss   96.51  514193964   \n",
            "354426   1487580006300255120           NaN  jessnail  122.22  580819864   \n",
            "3089023  1487580005553668971           NaN       NaN    9.52  430430758   \n",
            "1762400  1487580013841613016           NaN    kapous    3.65  586788406   \n",
            "...                      ...           ...       ...     ...        ...   \n",
            "954138   1487580007575323592           NaN       NaN    1.43  448126743   \n",
            "1363136  1487580005385896804           NaN       NaN    5.56  585244747   \n",
            "3033914  1487580005754995573           NaN       NaN    4.75  592260899   \n",
            "3455329  2055161088059638328           NaN     irisk    1.75  563932069   \n",
            "2220662  1487580010662330448           NaN   bodyton    6.83  378821606   \n",
            "\n",
            "                                 user_session  \n",
            "1141402  a897a9a9-5ebe-46df-91a0-db71d9fda2f0  \n",
            "2826120  5974f0cb-0916-469c-bf62-8843c7208959  \n",
            "354426   f508ad9a-198e-43f7-9772-e659133f4025  \n",
            "3089023  d9c35cd6-ce2b-445c-b467-4050a854f1c6  \n",
            "1762400  6248f4cb-e919-4251-afb7-3cac961d787c  \n",
            "...                                       ...  \n",
            "954138   937f8855-e137-4192-9c3f-787bf692317a  \n",
            "1363136  cb2505b0-7b37-4f15-b9a3-18cb4cd2999c  \n",
            "3033914  f6d34c77-c172-4714-be9e-873efe737346  \n",
            "3455329  5470ca45-c088-446b-8b6d-dfe7f68e81d4  \n",
            "2220662  9c5e7111-51c7-4937-9249-bc0052e67fa6  \n",
            "\n",
            "[50000 rows x 9 columns]\n"
          ]
        }
      ],
      "source": [
        "## 데이터 샘플로 뽑아서 분석 진행\n",
        "df_sample =df.sample(n=50000, random_state=111)\n",
        "print(df_sample)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "cf2930c9",
      "metadata": {
        "id": "cf2930c9",
        "outputId": "f5883eff-3b4b-4416-c2ec-774d5ff3af9c"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "event_type\n",
              "view                24451\n",
              "cart                13178\n",
              "remove_from_cart     9310\n",
              "purchase             3061\n",
              "Name: count, dtype: int64"
            ]
          },
          "execution_count": 10,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "##Event가 무엇이 있는지?\n",
        "##퍼널이 닫혀있는 가정\n",
        "df_sample.event_type.value_counts()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "21408cb0",
      "metadata": {
        "id": "21408cb0"
      },
      "outputs": [],
      "source": [
        "## 퍼널에 대한 비교도 보고싶고\n",
        "## Event별 제품이 다를까~?\n",
        "## 제품을 다량으로 구매하는 경우, 단품으로 구매하는 경우 -> 제품을 구매하는 어떤 범위가 어느정도인가?\n",
        "## 어떤 제품들끼리 잘 묶여서 구매가 되고 있는건가?!\n",
        "## 우리가 추천할 영역의 값이 무엇을 기준으로 해야 하나? -> product_id 것을 추천\n",
        "## product_id가 얼마나 영역의 커버리지할 수 있는 범위\n",
        "## 추천시스템을 구현할 때\n",
        "## 개인화추천시스템 -> 그전에 이미 단순하게도 충분히 구현할 수 있고, 꼭 개인화가 아니더라도 이벤트에 따라서 또는 실제 단순한 로직으로도 매출에 대해서 영향을 줄 수 있다.\n",
        "## 단순한 로직으로 추천\n",
        "## 가장 많이 구매한 것, 가장 같이 잘 팔리는 것 (동시구매 co-occurence), event 별 추천, 제품 또는 검색어 기반으로 추천도 달라질 수 있다.\n",
        "\n",
        "\n",
        "## 가설 1 . Event별 제품의 베스트가 차이가 클까?\n",
        "\n",
        "top_viewed=df_sample[df_sample['event_type']=='view']['product_id'].value_counts().head(5)\n",
        "top_carted=df_sample[df_sample['event_type']=='cart']['product_id'].value_counts().head(5)\n",
        "top_purchased=df_sample[df_sample['event_type']=='purchase']['product_id'].value_counts().head(5)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "1bdda4d3",
      "metadata": {
        "id": "1bdda4d3",
        "outputId": "d1fe9e64-4618-4ab9-8ca4-41e347a983ff"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "top_viewed product_id\n",
            "5809910    353\n",
            "5909810    115\n",
            "5877454     94\n",
            "5809912     89\n",
            "5886282     81\n",
            "Name: count, dtype: int64\n",
            "top_carted product_id\n",
            "5809910    90\n",
            "5700037    80\n",
            "5802432    75\n",
            "5854897    52\n",
            "5815662    47\n",
            "Name: count, dtype: int64\n",
            "top_purchased product_id\n",
            "5809910    22\n",
            "5700037    12\n",
            "5854897    11\n",
            "5528035    11\n",
            "5809912    11\n",
            "Name: count, dtype: int64\n"
          ]
        }
      ],
      "source": [
        "print('top_viewed',top_viewed)\n",
        "print('top_carted',top_carted)\n",
        "print('top_purchased',top_purchased)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "e2d0d51b",
      "metadata": {
        "id": "e2d0d51b"
      },
      "outputs": [],
      "source": [
        "## 퍼널에 대한 확인\n",
        "\n",
        "# 시계열로 변환\n",
        "df_sample['event_time'] = pd.to_datetime(df_sample['event_time'])\n",
        "\n",
        "## event_time 일자로 뽑으려면\n",
        "df_sample['date']=df_sample['event_time'].dt.date\n",
        "\n",
        "## 우리가 지금 퍼널을 카운팅하기 하기 위해서는 어떤 기준으로 가야할까?\n",
        "## user_id 카운팅\n",
        "daily_funnel_cohort=df_sample.groupby(['date','event_type'])['user_id'].nunique().unstack(fill_value=0)\n",
        "## cohort 컬럼 정리\n",
        "daily_funnel_cohort=daily_funnel_cohort[['view','cart','purchase']]\n",
        "\n",
        "## 전환율 계산\n",
        "daily_funnel_cohort['view->cart(%)'] = (daily_funnel_cohort['cart']/daily_funnel_cohort['view']*100).round(2)\n",
        "daily_funnel_cohort['cart->purchase(%)'] = (daily_funnel_cohort['purchase']/daily_funnel_cohort['cart']*100).round(2)\n",
        "daily_funnel_cohort['view->purchase(%)'] = (daily_funnel_cohort['purchase']/daily_funnel_cohort['view']*100).round(2)\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "b6ffb45e",
      "metadata": {
        "id": "b6ffb45e",
        "outputId": "2f551f4a-1e08-4ace-df23-ce86d5f23ede"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th>event_type</th>\n",
              "      <th>view</th>\n",
              "      <th>cart</th>\n",
              "      <th>purchase</th>\n",
              "      <th>view-&gt;cart(%)</th>\n",
              "      <th>cart-&gt;purchase(%)</th>\n",
              "      <th>view-&gt;purchase(%)</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>date</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>2019-12-01</th>\n",
              "      <td>766</td>\n",
              "      <td>401</td>\n",
              "      <td>89</td>\n",
              "      <td>52.35</td>\n",
              "      <td>22.19</td>\n",
              "      <td>11.62</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-02</th>\n",
              "      <td>825</td>\n",
              "      <td>413</td>\n",
              "      <td>89</td>\n",
              "      <td>50.06</td>\n",
              "      <td>21.55</td>\n",
              "      <td>10.79</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-03</th>\n",
              "      <td>805</td>\n",
              "      <td>460</td>\n",
              "      <td>115</td>\n",
              "      <td>57.14</td>\n",
              "      <td>25.00</td>\n",
              "      <td>14.29</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-04</th>\n",
              "      <td>779</td>\n",
              "      <td>439</td>\n",
              "      <td>103</td>\n",
              "      <td>56.35</td>\n",
              "      <td>23.46</td>\n",
              "      <td>13.22</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-05</th>\n",
              "      <td>766</td>\n",
              "      <td>393</td>\n",
              "      <td>122</td>\n",
              "      <td>51.31</td>\n",
              "      <td>31.04</td>\n",
              "      <td>15.93</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-06</th>\n",
              "      <td>719</td>\n",
              "      <td>404</td>\n",
              "      <td>105</td>\n",
              "      <td>56.19</td>\n",
              "      <td>25.99</td>\n",
              "      <td>14.60</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-07</th>\n",
              "      <td>696</td>\n",
              "      <td>381</td>\n",
              "      <td>80</td>\n",
              "      <td>54.74</td>\n",
              "      <td>21.00</td>\n",
              "      <td>11.49</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-08</th>\n",
              "      <td>753</td>\n",
              "      <td>403</td>\n",
              "      <td>83</td>\n",
              "      <td>53.52</td>\n",
              "      <td>20.60</td>\n",
              "      <td>11.02</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-09</th>\n",
              "      <td>936</td>\n",
              "      <td>484</td>\n",
              "      <td>102</td>\n",
              "      <td>51.71</td>\n",
              "      <td>21.07</td>\n",
              "      <td>10.90</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-10</th>\n",
              "      <td>871</td>\n",
              "      <td>477</td>\n",
              "      <td>131</td>\n",
              "      <td>54.76</td>\n",
              "      <td>27.46</td>\n",
              "      <td>15.04</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-11</th>\n",
              "      <td>844</td>\n",
              "      <td>459</td>\n",
              "      <td>121</td>\n",
              "      <td>54.38</td>\n",
              "      <td>26.36</td>\n",
              "      <td>14.34</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-12</th>\n",
              "      <td>818</td>\n",
              "      <td>459</td>\n",
              "      <td>122</td>\n",
              "      <td>56.11</td>\n",
              "      <td>26.58</td>\n",
              "      <td>14.91</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-13</th>\n",
              "      <td>743</td>\n",
              "      <td>357</td>\n",
              "      <td>97</td>\n",
              "      <td>48.05</td>\n",
              "      <td>27.17</td>\n",
              "      <td>13.06</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-14</th>\n",
              "      <td>702</td>\n",
              "      <td>344</td>\n",
              "      <td>91</td>\n",
              "      <td>49.00</td>\n",
              "      <td>26.45</td>\n",
              "      <td>12.96</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-15</th>\n",
              "      <td>759</td>\n",
              "      <td>379</td>\n",
              "      <td>87</td>\n",
              "      <td>49.93</td>\n",
              "      <td>22.96</td>\n",
              "      <td>11.46</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-16</th>\n",
              "      <td>829</td>\n",
              "      <td>441</td>\n",
              "      <td>134</td>\n",
              "      <td>53.20</td>\n",
              "      <td>30.39</td>\n",
              "      <td>16.16</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-17</th>\n",
              "      <td>800</td>\n",
              "      <td>387</td>\n",
              "      <td>112</td>\n",
              "      <td>48.38</td>\n",
              "      <td>28.94</td>\n",
              "      <td>14.00</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-18</th>\n",
              "      <td>797</td>\n",
              "      <td>402</td>\n",
              "      <td>116</td>\n",
              "      <td>50.44</td>\n",
              "      <td>28.86</td>\n",
              "      <td>14.55</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-19</th>\n",
              "      <td>747</td>\n",
              "      <td>366</td>\n",
              "      <td>91</td>\n",
              "      <td>49.00</td>\n",
              "      <td>24.86</td>\n",
              "      <td>12.18</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-20</th>\n",
              "      <td>656</td>\n",
              "      <td>299</td>\n",
              "      <td>76</td>\n",
              "      <td>45.58</td>\n",
              "      <td>25.42</td>\n",
              "      <td>11.59</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-21</th>\n",
              "      <td>629</td>\n",
              "      <td>334</td>\n",
              "      <td>85</td>\n",
              "      <td>53.10</td>\n",
              "      <td>25.45</td>\n",
              "      <td>13.51</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-22</th>\n",
              "      <td>685</td>\n",
              "      <td>346</td>\n",
              "      <td>86</td>\n",
              "      <td>50.51</td>\n",
              "      <td>24.86</td>\n",
              "      <td>12.55</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-23</th>\n",
              "      <td>762</td>\n",
              "      <td>397</td>\n",
              "      <td>92</td>\n",
              "      <td>52.10</td>\n",
              "      <td>23.17</td>\n",
              "      <td>12.07</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-24</th>\n",
              "      <td>686</td>\n",
              "      <td>346</td>\n",
              "      <td>85</td>\n",
              "      <td>50.44</td>\n",
              "      <td>24.57</td>\n",
              "      <td>12.39</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-25</th>\n",
              "      <td>635</td>\n",
              "      <td>329</td>\n",
              "      <td>93</td>\n",
              "      <td>51.81</td>\n",
              "      <td>28.27</td>\n",
              "      <td>14.65</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-26</th>\n",
              "      <td>610</td>\n",
              "      <td>280</td>\n",
              "      <td>75</td>\n",
              "      <td>45.90</td>\n",
              "      <td>26.79</td>\n",
              "      <td>12.30</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-27</th>\n",
              "      <td>592</td>\n",
              "      <td>255</td>\n",
              "      <td>62</td>\n",
              "      <td>43.07</td>\n",
              "      <td>24.31</td>\n",
              "      <td>10.47</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-28</th>\n",
              "      <td>482</td>\n",
              "      <td>271</td>\n",
              "      <td>63</td>\n",
              "      <td>56.22</td>\n",
              "      <td>23.25</td>\n",
              "      <td>13.07</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-29</th>\n",
              "      <td>504</td>\n",
              "      <td>249</td>\n",
              "      <td>33</td>\n",
              "      <td>49.40</td>\n",
              "      <td>13.25</td>\n",
              "      <td>6.55</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-30</th>\n",
              "      <td>470</td>\n",
              "      <td>185</td>\n",
              "      <td>32</td>\n",
              "      <td>39.36</td>\n",
              "      <td>17.30</td>\n",
              "      <td>6.81</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-31</th>\n",
              "      <td>225</td>\n",
              "      <td>92</td>\n",
              "      <td>10</td>\n",
              "      <td>40.89</td>\n",
              "      <td>10.87</td>\n",
              "      <td>4.44</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "event_type  view  cart  purchase  view->cart(%)  cart->purchase(%)  \\\n",
              "date                                                                 \n",
              "2019-12-01   766   401        89          52.35              22.19   \n",
              "2019-12-02   825   413        89          50.06              21.55   \n",
              "2019-12-03   805   460       115          57.14              25.00   \n",
              "2019-12-04   779   439       103          56.35              23.46   \n",
              "2019-12-05   766   393       122          51.31              31.04   \n",
              "2019-12-06   719   404       105          56.19              25.99   \n",
              "2019-12-07   696   381        80          54.74              21.00   \n",
              "2019-12-08   753   403        83          53.52              20.60   \n",
              "2019-12-09   936   484       102          51.71              21.07   \n",
              "2019-12-10   871   477       131          54.76              27.46   \n",
              "2019-12-11   844   459       121          54.38              26.36   \n",
              "2019-12-12   818   459       122          56.11              26.58   \n",
              "2019-12-13   743   357        97          48.05              27.17   \n",
              "2019-12-14   702   344        91          49.00              26.45   \n",
              "2019-12-15   759   379        87          49.93              22.96   \n",
              "2019-12-16   829   441       134          53.20              30.39   \n",
              "2019-12-17   800   387       112          48.38              28.94   \n",
              "2019-12-18   797   402       116          50.44              28.86   \n",
              "2019-12-19   747   366        91          49.00              24.86   \n",
              "2019-12-20   656   299        76          45.58              25.42   \n",
              "2019-12-21   629   334        85          53.10              25.45   \n",
              "2019-12-22   685   346        86          50.51              24.86   \n",
              "2019-12-23   762   397        92          52.10              23.17   \n",
              "2019-12-24   686   346        85          50.44              24.57   \n",
              "2019-12-25   635   329        93          51.81              28.27   \n",
              "2019-12-26   610   280        75          45.90              26.79   \n",
              "2019-12-27   592   255        62          43.07              24.31   \n",
              "2019-12-28   482   271        63          56.22              23.25   \n",
              "2019-12-29   504   249        33          49.40              13.25   \n",
              "2019-12-30   470   185        32          39.36              17.30   \n",
              "2019-12-31   225    92        10          40.89              10.87   \n",
              "\n",
              "event_type  view->purchase(%)  \n",
              "date                           \n",
              "2019-12-01              11.62  \n",
              "2019-12-02              10.79  \n",
              "2019-12-03              14.29  \n",
              "2019-12-04              13.22  \n",
              "2019-12-05              15.93  \n",
              "2019-12-06              14.60  \n",
              "2019-12-07              11.49  \n",
              "2019-12-08              11.02  \n",
              "2019-12-09              10.90  \n",
              "2019-12-10              15.04  \n",
              "2019-12-11              14.34  \n",
              "2019-12-12              14.91  \n",
              "2019-12-13              13.06  \n",
              "2019-12-14              12.96  \n",
              "2019-12-15              11.46  \n",
              "2019-12-16              16.16  \n",
              "2019-12-17              14.00  \n",
              "2019-12-18              14.55  \n",
              "2019-12-19              12.18  \n",
              "2019-12-20              11.59  \n",
              "2019-12-21              13.51  \n",
              "2019-12-22              12.55  \n",
              "2019-12-23              12.07  \n",
              "2019-12-24              12.39  \n",
              "2019-12-25              14.65  \n",
              "2019-12-26              12.30  \n",
              "2019-12-27              10.47  \n",
              "2019-12-28              13.07  \n",
              "2019-12-29               6.55  \n",
              "2019-12-30               6.81  \n",
              "2019-12-31               4.44  "
            ]
          },
          "execution_count": 23,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "daily_funnel_cohort"
      ]
    },
    {
      "cell_type": "markdown",
      "id": "6aeef605",
      "metadata": {
        "id": "6aeef605"
      },
      "source": [
        "### 필수과제1\n",
        "- 2019년 12월, 2019 10월, 11월 데이터도 샘플링하셔서 (100,000만 개 이상으로 샘플링해서)\n",
        "- 필수과제1.1. 월별 퍼널에 대한 분석이 필요하다. event에 대한 유저들의 퍼널율 계산하고\n",
        "- 필수과제1.2. 요일 지수를 확인해야 하므로, 요일 지수에 따른 시각화와 인사이트 정리\n",
        "- 필수과제1.3. 시간에 따른 인사이트 정리 필요 -> 시간에 따른 시각화와 인사이트 정리\n",
        "- 필수과제1.4. 베스트 제품의 이벤트별 달라지는가? -> 월별에 따른 이벤트별 베스트 제품이 달라지는가? 인사이트 정리\n",
        "----\n",
        "- 추천하기 전 제품들에 대한 월별, 시간별, 요일별 트렌드가 존재하는지를 살펴보자!\n",
        "- 총 4개의 파일로 ipynb 만들어서 노션에 업로드 하시면 됩니다."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "a7a37ba0",
      "metadata": {
        "id": "a7a37ba0"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "5ae3f291",
      "metadata": {
        "id": "5ae3f291"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "7c2651fd",
      "metadata": {
        "id": "7c2651fd",
        "outputId": "76956461-b679-4571-8268-89cc04bee484"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th>event_type</th>\n",
              "      <th>cart</th>\n",
              "      <th>purchase</th>\n",
              "      <th>remove_from_cart</th>\n",
              "      <th>view</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>date</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>2019-12-01</th>\n",
              "      <td>401</td>\n",
              "      <td>89</td>\n",
              "      <td>282</td>\n",
              "      <td>766</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-02</th>\n",
              "      <td>413</td>\n",
              "      <td>89</td>\n",
              "      <td>299</td>\n",
              "      <td>825</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-03</th>\n",
              "      <td>460</td>\n",
              "      <td>115</td>\n",
              "      <td>295</td>\n",
              "      <td>805</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-04</th>\n",
              "      <td>439</td>\n",
              "      <td>103</td>\n",
              "      <td>291</td>\n",
              "      <td>779</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-05</th>\n",
              "      <td>393</td>\n",
              "      <td>122</td>\n",
              "      <td>274</td>\n",
              "      <td>766</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-06</th>\n",
              "      <td>404</td>\n",
              "      <td>105</td>\n",
              "      <td>263</td>\n",
              "      <td>719</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-07</th>\n",
              "      <td>381</td>\n",
              "      <td>80</td>\n",
              "      <td>218</td>\n",
              "      <td>696</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-08</th>\n",
              "      <td>403</td>\n",
              "      <td>83</td>\n",
              "      <td>270</td>\n",
              "      <td>753</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-09</th>\n",
              "      <td>484</td>\n",
              "      <td>102</td>\n",
              "      <td>327</td>\n",
              "      <td>936</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-10</th>\n",
              "      <td>477</td>\n",
              "      <td>131</td>\n",
              "      <td>324</td>\n",
              "      <td>871</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-11</th>\n",
              "      <td>459</td>\n",
              "      <td>121</td>\n",
              "      <td>329</td>\n",
              "      <td>844</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-12</th>\n",
              "      <td>459</td>\n",
              "      <td>122</td>\n",
              "      <td>312</td>\n",
              "      <td>818</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-13</th>\n",
              "      <td>357</td>\n",
              "      <td>97</td>\n",
              "      <td>259</td>\n",
              "      <td>743</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-14</th>\n",
              "      <td>344</td>\n",
              "      <td>91</td>\n",
              "      <td>244</td>\n",
              "      <td>702</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-15</th>\n",
              "      <td>379</td>\n",
              "      <td>87</td>\n",
              "      <td>283</td>\n",
              "      <td>759</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-16</th>\n",
              "      <td>441</td>\n",
              "      <td>134</td>\n",
              "      <td>277</td>\n",
              "      <td>829</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-17</th>\n",
              "      <td>387</td>\n",
              "      <td>112</td>\n",
              "      <td>282</td>\n",
              "      <td>800</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-18</th>\n",
              "      <td>402</td>\n",
              "      <td>116</td>\n",
              "      <td>271</td>\n",
              "      <td>797</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-19</th>\n",
              "      <td>366</td>\n",
              "      <td>91</td>\n",
              "      <td>244</td>\n",
              "      <td>747</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-20</th>\n",
              "      <td>299</td>\n",
              "      <td>76</td>\n",
              "      <td>223</td>\n",
              "      <td>656</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-21</th>\n",
              "      <td>334</td>\n",
              "      <td>85</td>\n",
              "      <td>195</td>\n",
              "      <td>629</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-22</th>\n",
              "      <td>346</td>\n",
              "      <td>86</td>\n",
              "      <td>243</td>\n",
              "      <td>685</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-23</th>\n",
              "      <td>397</td>\n",
              "      <td>92</td>\n",
              "      <td>241</td>\n",
              "      <td>762</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-24</th>\n",
              "      <td>346</td>\n",
              "      <td>85</td>\n",
              "      <td>212</td>\n",
              "      <td>686</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-25</th>\n",
              "      <td>329</td>\n",
              "      <td>93</td>\n",
              "      <td>225</td>\n",
              "      <td>635</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-26</th>\n",
              "      <td>280</td>\n",
              "      <td>75</td>\n",
              "      <td>178</td>\n",
              "      <td>610</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-27</th>\n",
              "      <td>255</td>\n",
              "      <td>62</td>\n",
              "      <td>156</td>\n",
              "      <td>592</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-28</th>\n",
              "      <td>271</td>\n",
              "      <td>63</td>\n",
              "      <td>155</td>\n",
              "      <td>482</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-29</th>\n",
              "      <td>249</td>\n",
              "      <td>33</td>\n",
              "      <td>140</td>\n",
              "      <td>504</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-30</th>\n",
              "      <td>185</td>\n",
              "      <td>32</td>\n",
              "      <td>110</td>\n",
              "      <td>470</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2019-12-31</th>\n",
              "      <td>92</td>\n",
              "      <td>10</td>\n",
              "      <td>51</td>\n",
              "      <td>225</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "event_type  cart  purchase  remove_from_cart  view\n",
              "date                                              \n",
              "2019-12-01   401        89               282   766\n",
              "2019-12-02   413        89               299   825\n",
              "2019-12-03   460       115               295   805\n",
              "2019-12-04   439       103               291   779\n",
              "2019-12-05   393       122               274   766\n",
              "2019-12-06   404       105               263   719\n",
              "2019-12-07   381        80               218   696\n",
              "2019-12-08   403        83               270   753\n",
              "2019-12-09   484       102               327   936\n",
              "2019-12-10   477       131               324   871\n",
              "2019-12-11   459       121               329   844\n",
              "2019-12-12   459       122               312   818\n",
              "2019-12-13   357        97               259   743\n",
              "2019-12-14   344        91               244   702\n",
              "2019-12-15   379        87               283   759\n",
              "2019-12-16   441       134               277   829\n",
              "2019-12-17   387       112               282   800\n",
              "2019-12-18   402       116               271   797\n",
              "2019-12-19   366        91               244   747\n",
              "2019-12-20   299        76               223   656\n",
              "2019-12-21   334        85               195   629\n",
              "2019-12-22   346        86               243   685\n",
              "2019-12-23   397        92               241   762\n",
              "2019-12-24   346        85               212   686\n",
              "2019-12-25   329        93               225   635\n",
              "2019-12-26   280        75               178   610\n",
              "2019-12-27   255        62               156   592\n",
              "2019-12-28   271        63               155   482\n",
              "2019-12-29   249        33               140   504\n",
              "2019-12-30   185        32               110   470\n",
              "2019-12-31    92        10                51   225"
            ]
          },
          "execution_count": 19,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "df_sample.groupby(['date','event_type'])['user_id'].nunique().unstack(fill_value=0)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "77259b06",
      "metadata": {
        "id": "77259b06",
        "outputId": "8ac6480d-2658-4ddf-8684-8c93dd318134"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "1141402    2019-12-09\n",
              "2826120    2019-12-23\n",
              "354426     2019-12-03\n",
              "3089023    2019-12-25\n",
              "1762400    2019-12-14\n",
              "              ...    \n",
              "954138     2019-12-08\n",
              "1363136    2019-12-11\n",
              "3033914    2019-12-25\n",
              "3455329    2019-12-30\n",
              "2220662    2019-12-17\n",
              "Name: event_time, Length: 50000, dtype: object"
            ]
          },
          "execution_count": 16,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "df_sample['event_time'].dt.date"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "bee34be5",
      "metadata": {
        "id": "bee34be5",
        "outputId": "0e6edc7b-fd57-498a-b58d-92c66578d68d"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>event_time</th>\n",
              "      <th>event_type</th>\n",
              "      <th>product_id</th>\n",
              "      <th>category_id</th>\n",
              "      <th>category_code</th>\n",
              "      <th>brand</th>\n",
              "      <th>price</th>\n",
              "      <th>user_id</th>\n",
              "      <th>user_session</th>\n",
              "      <th>date</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>1141402</th>\n",
              "      <td>2019-12-09 19:04:29+00:00</td>\n",
              "      <td>view</td>\n",
              "      <td>5814516</td>\n",
              "      <td>1487580013539623112</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>13.49</td>\n",
              "      <td>247790217</td>\n",
              "      <td>a897a9a9-5ebe-46df-91a0-db71d9fda2f0</td>\n",
              "      <td>2019-12-09</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2826120</th>\n",
              "      <td>2019-12-23 12:44:51+00:00</td>\n",
              "      <td>view</td>\n",
              "      <td>5915004</td>\n",
              "      <td>1487580008028308447</td>\n",
              "      <td>NaN</td>\n",
              "      <td>babyliss</td>\n",
              "      <td>96.51</td>\n",
              "      <td>514193964</td>\n",
              "      <td>5974f0cb-0916-469c-bf62-8843c7208959</td>\n",
              "      <td>2019-12-23</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>354426</th>\n",
              "      <td>2019-12-03 16:25:54+00:00</td>\n",
              "      <td>view</td>\n",
              "      <td>5877456</td>\n",
              "      <td>1487580006300255120</td>\n",
              "      <td>NaN</td>\n",
              "      <td>jessnail</td>\n",
              "      <td>122.22</td>\n",
              "      <td>580819864</td>\n",
              "      <td>f508ad9a-198e-43f7-9772-e659133f4025</td>\n",
              "      <td>2019-12-03</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3089023</th>\n",
              "      <td>2019-12-25 19:06:15+00:00</td>\n",
              "      <td>cart</td>\n",
              "      <td>5608703</td>\n",
              "      <td>1487580005553668971</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>9.52</td>\n",
              "      <td>430430758</td>\n",
              "      <td>d9c35cd6-ce2b-445c-b467-4050a854f1c6</td>\n",
              "      <td>2019-12-25</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1762400</th>\n",
              "      <td>2019-12-14 11:41:25+00:00</td>\n",
              "      <td>view</td>\n",
              "      <td>5769914</td>\n",
              "      <td>1487580013841613016</td>\n",
              "      <td>NaN</td>\n",
              "      <td>kapous</td>\n",
              "      <td>3.65</td>\n",
              "      <td>586788406</td>\n",
              "      <td>6248f4cb-e919-4251-afb7-3cac961d787c</td>\n",
              "      <td>2019-12-14</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>954138</th>\n",
              "      <td>2019-12-08 14:29:44+00:00</td>\n",
              "      <td>remove_from_cart</td>\n",
              "      <td>5695961</td>\n",
              "      <td>1487580007575323592</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>1.43</td>\n",
              "      <td>448126743</td>\n",
              "      <td>937f8855-e137-4192-9c3f-787bf692317a</td>\n",
              "      <td>2019-12-08</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1363136</th>\n",
              "      <td>2019-12-11 10:17:56+00:00</td>\n",
              "      <td>cart</td>\n",
              "      <td>5800038</td>\n",
              "      <td>1487580005385896804</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>5.56</td>\n",
              "      <td>585244747</td>\n",
              "      <td>cb2505b0-7b37-4f15-b9a3-18cb4cd2999c</td>\n",
              "      <td>2019-12-11</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3033914</th>\n",
              "      <td>2019-12-25 10:03:55+00:00</td>\n",
              "      <td>purchase</td>\n",
              "      <td>5629984</td>\n",
              "      <td>1487580005754995573</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>4.75</td>\n",
              "      <td>592260899</td>\n",
              "      <td>f6d34c77-c172-4714-be9e-873efe737346</td>\n",
              "      <td>2019-12-25</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3455329</th>\n",
              "      <td>2019-12-30 08:41:10+00:00</td>\n",
              "      <td>purchase</td>\n",
              "      <td>5851607</td>\n",
              "      <td>2055161088059638328</td>\n",
              "      <td>NaN</td>\n",
              "      <td>irisk</td>\n",
              "      <td>1.75</td>\n",
              "      <td>563932069</td>\n",
              "      <td>5470ca45-c088-446b-8b6d-dfe7f68e81d4</td>\n",
              "      <td>2019-12-30</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2220662</th>\n",
              "      <td>2019-12-17 21:18:58+00:00</td>\n",
              "      <td>cart</td>\n",
              "      <td>5678044</td>\n",
              "      <td>1487580010662330448</td>\n",
              "      <td>NaN</td>\n",
              "      <td>bodyton</td>\n",
              "      <td>6.83</td>\n",
              "      <td>378821606</td>\n",
              "      <td>9c5e7111-51c7-4937-9249-bc0052e67fa6</td>\n",
              "      <td>2019-12-17</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>50000 rows × 10 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "                       event_time        event_type  product_id  \\\n",
              "1141402 2019-12-09 19:04:29+00:00              view     5814516   \n",
              "2826120 2019-12-23 12:44:51+00:00              view     5915004   \n",
              "354426  2019-12-03 16:25:54+00:00              view     5877456   \n",
              "3089023 2019-12-25 19:06:15+00:00              cart     5608703   \n",
              "1762400 2019-12-14 11:41:25+00:00              view     5769914   \n",
              "...                           ...               ...         ...   \n",
              "954138  2019-12-08 14:29:44+00:00  remove_from_cart     5695961   \n",
              "1363136 2019-12-11 10:17:56+00:00              cart     5800038   \n",
              "3033914 2019-12-25 10:03:55+00:00          purchase     5629984   \n",
              "3455329 2019-12-30 08:41:10+00:00          purchase     5851607   \n",
              "2220662 2019-12-17 21:18:58+00:00              cart     5678044   \n",
              "\n",
              "                 category_id category_code     brand   price    user_id  \\\n",
              "1141402  1487580013539623112           NaN       NaN   13.49  247790217   \n",
              "2826120  1487580008028308447           NaN  babyliss   96.51  514193964   \n",
              "354426   1487580006300255120           NaN  jessnail  122.22  580819864   \n",
              "3089023  1487580005553668971           NaN       NaN    9.52  430430758   \n",
              "1762400  1487580013841613016           NaN    kapous    3.65  586788406   \n",
              "...                      ...           ...       ...     ...        ...   \n",
              "954138   1487580007575323592           NaN       NaN    1.43  448126743   \n",
              "1363136  1487580005385896804           NaN       NaN    5.56  585244747   \n",
              "3033914  1487580005754995573           NaN       NaN    4.75  592260899   \n",
              "3455329  2055161088059638328           NaN     irisk    1.75  563932069   \n",
              "2220662  1487580010662330448           NaN   bodyton    6.83  378821606   \n",
              "\n",
              "                                 user_session        date  \n",
              "1141402  a897a9a9-5ebe-46df-91a0-db71d9fda2f0  2019-12-09  \n",
              "2826120  5974f0cb-0916-469c-bf62-8843c7208959  2019-12-23  \n",
              "354426   f508ad9a-198e-43f7-9772-e659133f4025  2019-12-03  \n",
              "3089023  d9c35cd6-ce2b-445c-b467-4050a854f1c6  2019-12-25  \n",
              "1762400  6248f4cb-e919-4251-afb7-3cac961d787c  2019-12-14  \n",
              "...                                       ...         ...  \n",
              "954138   937f8855-e137-4192-9c3f-787bf692317a  2019-12-08  \n",
              "1363136  cb2505b0-7b37-4f15-b9a3-18cb4cd2999c  2019-12-11  \n",
              "3033914  f6d34c77-c172-4714-be9e-873efe737346  2019-12-25  \n",
              "3455329  5470ca45-c088-446b-8b6d-dfe7f68e81d4  2019-12-30  \n",
              "2220662  9c5e7111-51c7-4937-9249-bc0052e67fa6  2019-12-17  \n",
              "\n",
              "[50000 rows x 10 columns]"
            ]
          },
          "execution_count": 18,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "df_sample"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "id": "db66a37b",
      "metadata": {
        "id": "db66a37b"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3 (ipykernel)",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.16"
    },
    "colab": {
      "provenance": [],
      "include_colab_link": true
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
